# Pipeline v2.0 Architecture

## Overview
v2.0 introduces a state-machine orchestrator, manifest-only dashboard data, an operations view, and a weekly decision engine.

## Core flow
`INIT -> SCOUT -> ANALYST -> DEV -> VALIDATE -> RECOVER (conditional) -> REVALIDATE -> PUBLISH -> COMPLETE`

Any fatal stage failure transitions to `FAILED` with checkpoint persisted for resume.

## Runtime artifacts
- State checkpoint: `pipeline-results/latest/state-machine.json`
- Event log (append-only): `pipeline-results/latest/run-events.jsonl`
- Run history (append-only): `pipeline-results/history/run-history.jsonl`

## Manifest data layer (frontend source of truth)
Generated by `scripts/generate_manifests.py`:
- `pipeline-results/latest/manifests/run-manifest.json`
- `pipeline-results/latest/manifests/ideas-manifest.json`
- `pipeline-results/latest/manifests/trend-manifest.json`
- `pipeline-results/latest/manifests/ops-manifest.json`

Dashboard (`pipeline-results/latest/index.html`) reads only these manifests (plus `weekly-decision.json`). Markdown remains artifact-only.

## Weekly decision engine
`scripts/weekly_decision_engine.py` produces:
- `pipeline-results/latest/weekly-decision.json`
- `pipeline-results/latest/weekly-product-bet-latest.md`

It emits one single product bet with confidence, rationale, and kill criteria.

## Resume behavior
- Fresh run: `python3 scripts/pipeline_state_machine.py`
- Resume run: `python3 scripts/pipeline_state_machine.py --resume`

Resume starts from the last non-terminal stage in `state-machine.json`.
